# Frontend - AI Assistant Application

Фронтенд-приложение для AI-ассистента, построенное на React 18 с TypeScript. Приложение предоставляет полнофункциональный интерфейс для общения с AI, управления пространствами, заметками, настройками уведомлений и поддержкой.

## Содержание

- [Технологии](#технологии)
- [Требования](#требования)
- [Установка и запуск](#установка-и-запуск)
- [Структура проекта](#структура-проекта)
- [Архитектура](#архитектура)
- [Компоненты](#компоненты)
- [Страницы](#страницы)

## Технологии

### Основные зависимости

- **React 18.2.0** - UI библиотека
- **TypeScript 5.2.2** - типизация
- **Vite 5.0.8** - сборщик
- **@hugeicons/react 1.1.1** - библиотека иконок
- **@hugeicons/core-free-icons 2.0.0** - набор бесплатных иконок

### Dev зависимости

- **@vitejs/plugin-react** - плагин Vite для React
- **@typescript-eslint/eslint-plugin** - ESLint плагин для TypeScript
- **eslint** - линтер кода
- **@types/react** - типы для React

## Требования

- **Node.js** >= 18.0.0
- **npm** >= 9.0.0 или **yarn** >= 1.22.0
- **Backend API** должен быть запущен на `http://localhost:8000` (или настроен прокси)

## Установка и запуск

### Установка зависимостей

```bash
cd frontend
npm install
```

### Запуск dev-сервера

```bash
npm run dev
```

Приложение будет доступно по адресу `http://localhost:3000`

### Сборка для production

```bash
npm run build
```

Собранные файлы будут в папке `dist/`


## Структура проекта

```
frontend/
├── public/                 # Статические файлы
├── src/                   # Исходный код
│   ├── assets/            # Ресурсы (изображения, иконки)
│   │   └── icons/
│   │       └── logo.svg
│   ├── components/        # React компоненты
│   │   ├── common/        # Общие компоненты
│   │   │   ├── BottomPanel/      # Нижняя панель инструментов
│   │   │   ├── ChatArea/         # Область чата
│   │   │   ├── Header/           # Заголовок страницы
│   │   │   ├── NotesPanel/       # Панель заметок
│   │   │   ├── PanelToggle/     # Переключатель панели
│   │   │   ├── Sidebar/          # Боковая панель
│   │   │   └── SupportPanel/      # Панель поддержки
│   │   └── ui/            # UI компоненты
│   │       ├── Button/          # Кнопка
│   │       ├── Icon/             # Иконка
│   │       └── Input/            # Поле ввода
│   ├── contexts/          # React контексты
│   │   ├── AuthContext.tsx       # Контекст аутентификации
│   │   └── LanguageContext.tsx   # Контекст языка
│   ├── pages/             # Страницы приложения
│   │   ├── AssistantPage/        # Главная страница ассистента
│   │   ├── LoginPage/            # Страница входа
│   │   ├── RegisterPage/         # Страница регистрации
│   │   ├── SettingsPage/         # Страница настроек
│   │   ├── SpaceDetailPage/      # Детальная страница пространства
│   │   ├── SpacesListPage/       # Список пространств
│   │   └── SpacesPage/           # Страница пространств
│   ├── styles/            # Глобальные стили
│   │   ├── globals.css           # Глобальные стили
│   │   └── variables.css         # CSS переменные
│   ├── types/             # TypeScript типы
│   │   └── index.ts
│   ├── utils/             # Утилиты
│   │   ├── api.ts                # API клиент
│   │   ├── i18n.ts               # Система переводов
│   │   └── icons.tsx             # Маппинг иконок
│   ├── App.tsx            # Главный компонент приложения
│   └── main.tsx           # Точка входа
├── index.html             # HTML шаблон
├── package.json           # Зависимости и скрипты
├── tsconfig.json          # Конфигурация TypeScript
├── vite.config.ts         # Конфигурация Vite
└── README.md              # Документация
```

## Архитектура

### Общая архитектура

Приложение использует архитектуру на основе React с разделением на:

1. **Pages** - страницы верхнего уровня, управляющие роутингом
2. **Components** - переиспользуемые компоненты
3. **Contexts** - глобальное состояние через React Context
4. **Utils** - утилиты и вспомогательные функции
5. **Types** - TypeScript интерфейсы и типы

### Поток данных

```
User Action → Component → Context/API → State Update → Re-render
```

### Роутинг

Роутинг реализован через клиентский роутинг в `App.tsx`:

- `/` или `/assistant` - главная страница ассистента
- `/login` - страница входа
- `/register` - страница регистрации
- `/spaces` - список пространств
- `/spaces/:id` - детальная страница пространства
- `/settings` - настройки

### Аутентификация

Аутентификация управляется через `AuthContext`:

- Токены хранятся в `localStorage`
- Автоматическое обновление токенов через refresh token
- Защита маршрутов для авторизованных пользователей

## Компоненты

### UI Компоненты

#### Icon

Компонент для отображения SVG иконок из библиотеки `@hugeicons/react`.

**Расположение:** `src/components/ui/Icon/`

**Использование:**
```tsx
import { Icon } from '../../components/ui/Icon';
import { ICONS } from '../../utils/icons';

<Icon src={ICONS.rocket} size="md" color="#6366f1" />
```

**Props:**
- `src: string` - ключ иконки из `ICONS`
- `size?: 'sm' | 'md' | 'lg'` - размер иконки
- `color?: string` - цвет иконки
- `className?: string` - дополнительные CSS классы


### Common Компоненты

#### Sidebar

Боковая панель с навигацией, списком чатов и пространств.

**Расположение:** `src/components/common/Sidebar/`

**Функциональность:**
- Отображение логотипа
- Кнопка создания нового чата
- Список чатов с контекстным меню (переименование, удаление)
- Навигация (Пространства, Настройки)
- Регистрация для неавторизованных пользователей
- Поддержка свернутого состояния

**Props:**
- `threads: ChatThread[]` - список чатов
- `activeThreadId?: string | null` - ID активного чата
- `isCollapsed: boolean` - состояние свернутости
- `onToggleCollapse: () => void` - переключение свернутости
- `onNewThread: () => void` - создание нового чата
- `onThreadSelect: (threadId: string) => void` - выбор чата
- `onThreadDelete: (threadId: string) => void` - удаление чата
- `onThreadRename: (threadId: string, newTitle: string) => void` - переименование чата
- `onSettingsClick?: () => void` - клик по настройкам

#### Header

Заголовок страницы с названием чата, выбором модели и профилем.

**Расположение:** `src/components/common/Header/`

**Функциональность:**
- Отображение названия чата (редактируемое)
- Кнопка выбора модели AI (brain icon)
- Выбор языка (русский/английский)
- Уведомления
- Профиль пользователя

**Props:**
- `title?: string` - заголовок
- `threadId?: string | null` - ID чата
- `onRename?: (newTitle: string) => void` - переименование
- `activeTool?: string` - активный инструмент
- `onToolSelect?: (tool: string) => void` - выбор инструмента

#### ChatArea

Область чата с сообщениями и вводом.

**Расположение:** `src/components/common/ChatArea/`

**Функциональность:**
- Отображение приветственного экрана
- Список сообщений (пользователь/ассистент)
- Индикатор загрузки "Поиск и формирование ответа"
- Поле ввода с авто-ресайзом
- Выбор модели AI
- Панель заметок
- Вложения и микрофон (UI готов)

**Props:**
- `userName?: string` - имя пользователя
- `messages?: ChatMessage[]` - список сообщений
- `activeTool?: string` - активный инструмент
- `onToolSelect?: (tool: string) => void` - выбор инструмента
- `onSendMessage?: (message: string) => void` - отправка сообщения
- `isWaitingForResponse?: boolean` - ожидание ответа

#### BottomPanel

Нижняя панель инструментов (альтернатива Sidebar).

**Расположение:** `src/components/common/BottomPanel/`

**Функциональность:**
- Кнопка создания нового чата
- Список активных чатов
- Кнопка перехода к пространствам

**Props:**
- `threads?: ChatThread[]` - список чатов
- `activeThreadId?: string | null` - ID активного чата
- `onThreadSelect?: (threadId: string) => void` - выбор чата
- `onNewThread?: () => void` - создание нового чата

#### PanelToggle

Переключатель между Sidebar и BottomPanel с возможностью перетаскивания.

**Расположение:** `src/components/common/PanelToggle/`

**Функциональность:**
- Переключение режима панели (sidebar/bottom)
- Перетаскивание по краям экрана
- Сохранение позиции в localStorage

#### NotesPanel

Панель для работы с заметками.

**Расположение:** `src/components/common/NotesPanel/`

**Функциональность:**
- Список заметок
- Создание новой заметки
- Редактирование заметки
- Удаление заметки
- Просмотр содержимого заметки

**Props:**
- `spaceId?: number` - ID пространства (опционально)
- `onClose?: () => void` - закрытие панели

#### SupportPanel

Панель поддержки с формой обратной связи и справочными статьями.

**Расположение:** `src/components/common/SupportPanel/`

**Функциональность:**
- Форма обратной связи (для авторизованных и неавторизованных)
- Список справочных статей
- Модальное окно просмотра статьи

## Страницы

### AssistantPage

Главная страница приложения с чатом и ассистентом.

**Расположение:** `src/pages/AssistantPage/`

**Функциональность:**
- Управление чатами (создание, выбор, удаление, переименование)
- Отправка сообщений в AI
- Получение ответов от AI
- Переключение между Sidebar и BottomPanel
- Интеграция с SupportPanel
- Сохранение истории чатов в localStorage
- Загрузка истории из API

**Состояние:**
- `threads: Map<string, ThreadData>` - карта чатов
- `activeThreadId: string | null` - активный чат
- `messages: ChatMessage[]` - сообщения текущего чата
- `panelMode: 'sidebar' | 'bottom'` - режим панели
- `isSidebarCollapsed: boolean` - свернута ли боковая панель
- `showSupportPanel: boolean` - показывать ли панель поддержки
- `isWaitingForResponse: boolean` - ожидание ответа от AI

### LoginPage

Страница входа в систему.

**Расположение:** `src/pages/LoginPage/`

**Функциональность:**
- Форма входа (email, пароль)
- Валидация полей
- Обработка ошибок
- Переход на страницу регистрации
- Поддержка переводов (русский/английский)

### RegisterPage

Страница регистрации нового пользователя.

**Расположение:** `src/pages/RegisterPage/`

**Функциональность:**
- Форма регистрации (имя, email, пароль, название компании)
- Валидация полей
- Обработка ошибок
- Переход на страницу входа

### SpacesListPage

Страница со списком всех пространств.

**Расположение:** `src/pages/SpacesListPage/`

**Функциональность:**
- Сетка карточек пространств
- Создание нового пространства
- Редактирование пространства
- Архивирование/разархивирование
- Удаление пространства
- Фильтр по архивированным
- Пагинация
- Контекстное меню для каждого пространства

**Отображаемая информация:**
- Название пространства
- Описание
- Количество чатов
- Количество заметок
- Количество тегов
- Дата обновления
- Статус (активное/архивированное)

### SpaceDetailPage

Детальная страница пространства с вкладками.

**Расположение:** `src/pages/SpaceDetailPage/`

**Вкладки:**
1. **Чаты** - список чатов в пространстве
2. **Заметки** - список заметок в пространстве
3. **Теги** - управление тегами (создание, редактирование, удаление)
4. **Настройки** - настройки пространства, поддержка, уведомления

**Функциональность:**
- Просмотр и редактирование информации о пространстве
- Экспорт данных (UI готов)
- Архивирование/разархивирование
- Удаление пространства
- Управление тегами
- Настройки уведомлений
- Форма обратной связи
- Справочные статьи

### SettingsPage

Страница настроек (используется для поддержки).

**Расположение:** `src/pages/SettingsPage/`

**Функциональность:**
- Форма обратной связи
- Список справочных статей
- Модальное окно просмотра статьи

## API интеграция

### API клиент

**Расположение:** `src/utils/api.ts`

### Базовый запрос

Все API запросы проходят через функцию `apiRequest`:

```typescript
const response = await apiRequest<ResponseType>('/endpoint', {
  method: 'POST',
  body: JSON.stringify(data),
});
```

**Особенности:**
- Автоматическое добавление токена авторизации
- Обработка ошибок 401 (автоматический refresh token)
- Обработка ошибок сети
- Типизация ответов

